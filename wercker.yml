box:
    id: golang
    ports:
        - "5000"

dev:
    steps:
        - internal/watch:
            code: |
                go build ./...
                ./source
            reload: true

# Build definition
build:
    steps:

    - script:
        name: hello-world
        code: echo $HELLO_MESSAGE

    # golint step!
    - wercker/golint

    # Build the project
    - script:
        name: go build
        code: |
            go build ./...

    # Test the project
    - script:
        name: go test
        code: |
            go test ./...

    - internal/docker-scratch-push:
        username: $DOCKERHUB_USERNAME
        password: $DOCKERHUB_PASSWORD
        cmd: /fun
        tag: $WERCKER_GIT_COMMIT
        repository: rikgibson/fun-with-golang
#        registry: https://registry.hub.docker.com

hello-world:
    steps:

    - script:
        name: hello-world
        code: echo $HELLO_MESSAGE